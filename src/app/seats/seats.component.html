<div *ngIf="isAdmin">
  <nav class="navbar navbar-dark bg-primary navbar-expand">
    <ul class="navbar-nav">
      <li class="nav-item" routerLinkActive="active">
        <a class="nav-link" routerLink="/admin">Admin</a>
      </li>
      <li class="nav-item" routerLinkActive="active">
        <a class="nav-link" routerLink="/addBus">Add Bus</a>
      </li>
      <li class="nav-item" routerLinkActive="active">
        <a class="nav-link" (click)="logout()">Logout</a>
      </li>
    </ul>
  </nav>
  </div>

  <div *ngIf="!isAdmin">
    <nav class="navbar navbar-dark bg-primary navbar-expand">
      <ul class="navbar-nav">
        <li class="nav-item" routerLinkActive="active">
          <a class="nav-link" routerLink="/user">User</a>
        </li>
        <li class="nav-item" routerLinkActive="active">
          <a class="nav-link"  (click)="logout()">Logout</a>
        </li>
      </ul>
    </nav>
</div>

<div class="container">
  <!-- <h2>Bus Seat Booking</h2> -->



  <div class="ctnr">
    <!-- Lower Single Seats -->
    <div class="seats">
      <div class="seat-container">
        <label
          *ngFor="let seat of lowerSingleSeats"
          class="seat"
          [class.admin]="isAdmin"
          [class.booked]="seat.seatStatus === 'booked'"
          [class.available]="seat.seatStatus === 'Available'"
          [class.selected]="seat.seatStatus === 'selected'"
          [class.ladies]="seat.seatStatus === 'ladies'"
          [class.ladiesSelected]="seat.seatStatus === 'ladiesSelected'"
          (click)="toggleSeatStatus(seat)"
        >
          {{ seat.name }}
        </label>
      </div>

      <!-- Double Lower Berth Seats -->
      <div class="seat-container">
        <label
          *ngFor="let seat of doubleLowerBerthSeats; let i = index"
          class="berth"
          [class.admin]="isAdmin"
          [class.booked]="seat.seatStatus === 'booked'"
          [class.available]="seat.seatStatus === 'Available'"
          [class.selected]="seat.seatStatus === 'selected'"
          [class.ladies]="seat.seatStatus === 'ladies'"
          [class.ladiesSelected]="seat.seatStatus === 'ladiesSelected'"
          [class.margin-left]="i < 6"
          (click)="toggleSeatStatus(seat)"
        >
          {{ seat.name }}
        </label>
      </div>
    </div>

    <div class="seats">
      <!-- Single Upper Berth Seats -->
      <div class="seat-container">
        <label
          *ngFor="let seat of singleUpperBerthSeats"
          class="berth"
          [class.admin]="isAdmin"
          [class.booked]="seat.seatStatus === 'booked'"
          [class.available]="seat.seatStatus === 'Available'"
          [class.selected]="seat.seatStatus === 'selected'"
          [class.ladies]="seat.seatStatus === 'ladies'"
          [class.ladiesSelected]="seat.seatStatus === 'ladiesSelected'"
          (click)="toggleSeatStatus(seat)"
        >
          {{ seat.name }}
        </label>
      </div>

      <!-- Double Upper Berth Seats -->
      <div class="seat-container">
        <label
          *ngFor="let seat of doubleUpperBerthSeats; let i = index"
          class="berth"
          [class.admin]="isAdmin"
          [class.booked]="seat.seatStatus === 'booked'"
          [class.available]="seat.seatStatus === 'Available'"
          [class.selected]="seat.seatStatus === 'selected'"
          [class.ladies]="seat.seatStatus === 'ladies'"
          [class.ladiesSelected]="seat.seatStatus === 'ladiesSelected'"
          [class.margin-left]="i < 6"
          (click)="toggleSeatStatus(seat)"
        >
          {{ seat.name }}
        </label>
      </div>
    </div>

    <div class="legend">
      <h3>LEGEND</h3>
      <ul>
        <li class="legend-item">
          <div class="legend-color booked"></div>
          <span>Booked</span>
        </li>
        <li class="legend-item">
          <div class="legend-color available"></div>
          <span>Available</span>
        </li>
        <li class="legend-item">
          <div class="legend-color ladies"></div>
          <span>Ladies</span>
        </li>
        <li class="legend-item">
          <div class="legend-color ladiesSelected"></div>
          <span>Ladies Selected</span>
        </li>
        <li class="legend-item">
          <div class="legend-color selected"></div>
          <span>Selected</span>
        </li>
      </ul>
      <p>Abbreviations:</p>
      <ul>
        <li>LS - Lower Seat</li>
        <li>DLB - Double Lower Berth</li>
        <li>DUB - Double Upper Berth</li>
        <li>SLB - Single Upper Berth</li>
      </ul>
    </div>
  



  </div>
  <br />
  <br />
  <div *ngIf="selectedSeats.length > 0 && !isAdmin">
    <h4>Selected Seats</h4>
    <ul>
      <li *ngFor="let seat of selectedSeats">{{ seat.name }}</li>
    </ul>
    <button class="btn btn-primary" (click)="bookSelectedSeats()">
      Book Seats
    </button>
  </div>

  <div *ngIf="isAdmin">
    <div class="container">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Seat Name</th>
            <th>Passenger Name</th>
            <th>Passenger Age</th>
            <th>Passenger Gender</th>
            <th>Seat Price</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let seat of allSeats">
            <tr *ngIf="seat.seatStatus === 'booked'">
              <td>{{ seat.name }}</td>
              <td>{{ seat.passengerDetails?.passengerName || "N/A" }}</td>
              <td>{{ seat.passengerDetails?.passengerAge || "N/A" }}</td>
              <td>{{ seat.passengerDetails?.passengerGender || "N/A" }}</td>
              <td>{{ seat.seatPrice || "N/A" }}</td>
              <td>
                <button class="btn btn-primary" (click)="cancelSeat(seat.name, seat.seatPrice)">Cancel Seat</button>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
    
    
  </div>
</div>
