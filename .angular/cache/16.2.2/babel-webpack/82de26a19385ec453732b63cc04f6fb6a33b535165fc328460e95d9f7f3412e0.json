{"ast":null,"code":"var _class;\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Input, Output, EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nexport class SeatsComponent {}\n_class = SeatsComponent;\n_class.ɵfac = function SeatsComponent_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-seats\"]],\n  decls: 0,\n  vars: 0,\n  template: function SeatsComponent_Template(rf, ctx) {},\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});\nexport let SelectSeatComponent = class SelectSeatComponent {\n  constructor(route, BusService) {\n    this.route = route;\n    this.BusService = BusService;\n    this.closeModal = new EventEmitter();\n    this.showSeatList = [];\n    this.total = 0;\n    this.fillupSeat = [];\n    this.alert = false;\n  }\n  ngOnInit() {\n    this.getbookSeat();\n  }\n  Seat(e) {\n    let seats = [];\n    seats = this.showSeatList.map(iteam => {\n      return iteam.seatNo;\n    });\n    let id = document.getElementById(e);\n    if (this.fillupSeat.indexOf(String(e)) < 0 && seats.indexOf(e) < 0) {\n      if (this.showSeatList.length != 4) {\n        id.innerHTML = `   <img src=\"../assets/img/fseat.png\" alt=\"\">`;\n        let seat = {\n          seatNo: e,\n          fare: this.bus.fare,\n          seatClass: 'economy'\n        };\n        this.totalFare(seat.fare);\n        this.showList(seat);\n      } else {\n        this.alert = true;\n      }\n    }\n  }\n  showList(seat) {\n    this.showSeatList.push(seat);\n  }\n  totalFare(fare) {\n    this.total += fare;\n  }\n  confirmJourney() {\n    let route = JSON.parse(localStorage.getItem(\"route\"));\n    let seats = [];\n    seats = this.showSeatList.map(iteam => {\n      return iteam.seatNo;\n    });\n    let journey = {\n      bus: this.bus,\n      seats: seats,\n      fare: Number(this.total),\n      journey_route: route\n    };\n    localStorage.setItem(\"journey\", JSON.stringify(journey));\n    this.route.navigate(['user-form']);\n    this.closeModal.emit();\n  }\n  getbookSeat() {\n    let route = JSON.parse(localStorage.getItem(\"route\"));\n    let busid = this.bus.$key;\n    let key = String(new Date(route.date).getTime());\n    console.log(busid, key);\n    this.subscription = this.BusService.getFillupseat(key, busid).subscribe(res => {\n      for (key in res) {\n        for (let i in res[key].seats) {\n          this.fillupSeat.push(res[key].seats[i]);\n          this.changeSeatColor(res[key].seats[i]);\n        }\n      }\n    });\n  }\n  changeSeatColor(seatNo) {\n    let id = document.getElementById(seatNo);\n    id.innerHTML = `  <img src=\"../assets/img/bookseat.png\">`;\n    id.removeEventListener(\"click\", this.Seat);\n  }\n  ngOnDestroy() {\n    this.subscription.unsubscribe();\n  }\n};\n__decorate([Input('bus')], SelectSeatComponent.prototype, \"bus\", void 0);\n__decorate([Output('closeModal')], SelectSeatComponent.prototype, \"closeModal\", void 0);\nSelectSeatComponent = __decorate([Component({\n  selector: 'select-seat',\n  templateUrl: './select-seat.component.html',\n  styleUrls: ['./select-seat.component.css']\n})], SelectSeatComponent);","map":{"version":3,"names":["Component","Input","Output","EventEmitter","SeatsComponent","selectors","decls","vars","template","SeatsComponent_Template","rf","ctx","styles","SelectSeatComponent","constructor","route","BusService","closeModal","showSeatList","total","fillupSeat","alert","ngOnInit","getbookSeat","Seat","e","seats","map","iteam","seatNo","id","document","getElementById","indexOf","String","length","innerHTML","seat","fare","bus","seatClass","totalFare","showList","push","confirmJourney","JSON","parse","localStorage","getItem","journey","Number","journey_route","setItem","stringify","navigate","emit","busid","$key","key","Date","date","getTime","console","log","subscription","getFillupseat","subscribe","res","i","changeSeatColor","removeEventListener","ngOnDestroy","unsubscribe","__decorate","selector","templateUrl","styleUrls"],"sources":["E:\\Web\\Angular\\academy-project\\src\\app\\seats\\seats.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-seats',\n  templateUrl: './seats.component.html',\n  styleUrls: ['./seats.component.css']\n})\nexport class SeatsComponent {\n\n}\n\n\nimport { Component, OnInit, Input, Output, EventEmitter, OnDestroy } from '@angular/core';\nimport { Seat } from '../models/seat.model';\nimport { Journey } from '../models/journey.model';\nimport { Journey_Route } from '../models/route.model';\nimport { Router } from '@angular/router';\nimport { Bus } from '../models/bus.model';\nimport { SelectBusService } from '../services/selectBus.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'select-seat',\n  templateUrl: './select-seat.component.html',\n  styleUrls: ['./select-seat.component.css']\n})\nexport class SelectSeatComponent implements OnInit ,OnDestroy{\n  @Input('bus') bus:Bus;\n  @Output('closeModal') closeModal = new EventEmitter()\nshowSeatList:Seat[]=[];\ntotal=0;\nfillupSeat=[];\nalert=false;\n\nsubscription:Subscription;\n  constructor(\n    private route:Router,\n    private BusService:SelectBusService\n  ) { }\n\n  ngOnInit() {\nthis.getbookSeat();\n  }\n\n  Seat(e) {\n   let seats=[];\n   seats= this.showSeatList.map(iteam=>{\n     return iteam.seatNo\n   })\n    let id = document.getElementById(e);\n  \n    if((this.fillupSeat.indexOf(String(e))<0) && (seats.indexOf(e)<0)){\n      if((this.showSeatList.length!=4)) {\n        id.innerHTML = `   <img src=\"../assets/img/fseat.png\" alt=\"\">`\n      \n        let seat={\n          seatNo:e,\n          fare:this.bus.fare,\n          seatClass:'economy'\n        }\n        this.totalFare(seat.fare);\n        this.showList(seat);\n      }\n      else{\n        this.alert=true;\n      }\n    }\n\n  }\n\n  showList(seat){\n      this.showSeatList.push(seat)\n  }\n\n  totalFare(fare){\n    this.total+=fare;\n  }\n\n  confirmJourney(){\n    let route:Journey_Route= JSON.parse(localStorage.getItem(\"route\"))\n\n    let seats=[];\n  seats= this.showSeatList.map(iteam=>{\n    return iteam.seatNo\n  });\n\n  let journey :Journey={\n    bus:this.bus,\n    seats:seats,\n    fare:Number(this.total),\n    journey_route:route\n  }\n\nlocalStorage.setItem(\"journey\",JSON.stringify(journey))\nthis.route.navigate(['user-form']);\nthis.closeModal.emit();\n  }\n\n\n  getbookSeat(){\n    \n    let route:Journey_Route= JSON.parse(localStorage.getItem(\"route\"))\n    let busid=this.bus.$key;\n    let key = String(new Date(route.date).getTime());\n    console.log(busid,key)\n    this.subscription=this.BusService.getFillupseat(key,busid)\n    .subscribe(res=>{\n      for(key in res){\n        for(let i in res[key].seats){\n          this.fillupSeat.push(res[key].seats[i])\n          this.changeSeatColor(res[key].seats[i])\n        }\n      }\n    })\n  }\n\n  changeSeatColor(seatNo){\n    let id= document.getElementById(seatNo)\n    id.innerHTML=`  <img src=\"../assets/img/bookseat.png\">`\n    id.removeEventListener(\"click\",this.Seat);\n    \n  \n  }\n\n  ngOnDestroy(){\n    this.subscription.unsubscribe();\n  }\n\n} "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}