{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nexport let SummaryComponent = class SummaryComponent {\n  constructor(authService, cd, router, http, bookingService, seatService) {\n    this.authService = authService;\n    this.cd = cd;\n    this.router = router;\n    this.http = http;\n    this.bookingService = bookingService;\n    this.seatService = seatService;\n    this.passengerDataArray = this.bookingService.getconfirmSeats();\n    this.adjSeats = this.bookingService.getAdjSeats();\n    this.adjSeatStatus = [];\n    this.gender = this.bookingService.getGender();\n  }\n  ngOnInit() {\n    // console.log(this.passengerDataArray + 'pass');\n    this.totalSeatPrice = this.passengerDataArray.reduce((total, data) => total + data.seatPrice, 0);\n    // console.log(this.femaleSeats);\n  }\n\n  logout() {\n    this.authService.logout();\n  }\n  onSubmit() {\n    this.gender = this.bookingService.getGender();\n    // console.log(this.gender);\n    for (const [index, dta] of this.passengerDataArray.entries()) {\n      this.cd.detectChanges();\n      if (dta.passengerData.passengerGender === 'female') {\n        this.adjSeatStatus.push('female');\n      }\n      if (dta.passengerData.passengerGender === 'male') {\n        this.adjSeatStatus.push('male');\n      }\n      const data = {\n        seatStatus: 'booked',\n        seatPrice: dta.seatPrice,\n        passengerDetails: {\n          passengerName: dta.passengerData.passengerName,\n          passengerAge: dta.passengerData.passengerAge,\n          passengerGender: this.gender[index] || dta.passengerData.passengerGender\n        }\n      };\n      // console.log(this.gender[index]);\n      const busId = this.seatService.getBusData();\n      this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/-' + busId + '/seats/' + dta.seatName + '.json', data).subscribe(res => {\n        // console.log(dta.seatName + res+ 'success'+ busId);\n        window.alert('Ticket booked successfully!');\n        this.router.navigate(['/user']);\n      }, error => {\n        // console.log(error);\n        window.alert('Error: ' + error.message);\n      });\n    }\n    // console.log(this.adjSeatStatus);\n    for (const [index, dta] of this.adjSeats.entries()) {\n      const male = {\n        seatStatus: 'gents',\n        seatPrice: dta.seatPrice,\n        passengerDetails: {\n          passengerName: '',\n          passengerAge: '',\n          passengerGender: ''\n        }\n      };\n      const female = {\n        seatStatus: 'ladies',\n        seatPrice: dta.seatPrice,\n        passengerDetails: {\n          passengerName: '',\n          passengerAge: '',\n          passengerGender: ''\n        }\n      };\n      const data = this.adjSeatStatus[index] === 'male' ? male : female;\n      const busId = this.seatService.getBusData();\n      this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/-' + busId + '/seats/' + dta.name + '.json', data).subscribe(res => {\n        // console.log(dta.seatName + res+ 'success'+ busId) ;\n      }, error => {\n        // console.log(error);\n        window.alert('Error: ' + error.message);\n      });\n    }\n  }\n};\nSummaryComponent = __decorate([Component({\n  selector: 'app-summary',\n  templateUrl: './summary.component.html',\n  styleUrls: ['./summary.component.css']\n})], SummaryComponent);","map":{"version":3,"names":["Component","SummaryComponent","constructor","authService","cd","router","http","bookingService","seatService","passengerDataArray","getconfirmSeats","adjSeats","getAdjSeats","adjSeatStatus","gender","getGender","ngOnInit","totalSeatPrice","reduce","total","data","seatPrice","logout","onSubmit","index","dta","entries","detectChanges","passengerData","passengerGender","push","seatStatus","passengerDetails","passengerName","passengerAge","busId","getBusData","put","seatName","subscribe","res","window","alert","navigate","error","message","male","female","name","__decorate","selector","templateUrl","styleUrls"],"sources":["E:\\Web\\academy-project\\src\\app\\summary\\summary.component.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\r\nimport { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { AuthService } from '../services/auth.service';\r\nimport { BookingService } from '../services/booking.service';\r\nimport { SeatService } from '../seat.service';\r\n\r\n@Component({\r\n  selector: 'app-summary',\r\n  templateUrl: './summary.component.html',\r\n  styleUrls: ['./summary.component.css']\r\n})\r\nexport class SummaryComponent implements OnInit{\r\n\r\n  constructor(private authService: AuthService,private cd: ChangeDetectorRef,private router: Router, private http: HttpClient, private bookingService: BookingService, private seatService: SeatService) { }\r\n\r\n  passengerDataArray = this.bookingService.getconfirmSeats();\r\n  adjSeats = this.bookingService.getAdjSeats();\r\n  adjSeatStatus:any[] = [];\r\n  totalSeatPrice: number;\r\n  gender: any[] = this.bookingService.getGender();\r\n  \r\n  ngOnInit(){\r\n    // console.log(this.passengerDataArray + 'pass');\r\n    this.totalSeatPrice = this.passengerDataArray.reduce((total, data) => total + data.seatPrice, 0);\r\n    // console.log(this.femaleSeats);\r\n  }\r\n\r\n  logout(){\r\n    this.authService.logout();\r\n  }\r\n  onSubmit(){\r\n\r\n    this.gender = this.bookingService.getGender();\r\n    // console.log(this.gender);\r\n    \r\n    for (const [index, dta] of this.passengerDataArray.entries()){\r\n      \r\n      this.cd.detectChanges();\r\n      if (dta.passengerData.passengerGender === 'female'){\r\n        this.adjSeatStatus.push('female');\r\n      }\r\n      if (dta.passengerData.passengerGender === 'male'){\r\n        this.adjSeatStatus.push('male');\r\n      }\r\n      const data = {\r\n        seatStatus: 'booked',\r\n        seatPrice: dta.seatPrice,\r\n        passengerDetails: {\r\n          passengerName: dta.passengerData.passengerName,\r\n          passengerAge: dta.passengerData.passengerAge,\r\n          passengerGender: this.gender[index] || dta.passengerData.passengerGender,\r\n        }\r\n      }\r\n      // console.log(this.gender[index]);\r\n\r\n      const busId = this.seatService.getBusData();\r\n\r\n      this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/-' + busId +'/seats/' + dta.seatName +'.json', data)\r\n      .subscribe((res) =>{\r\n        // console.log(dta.seatName + res+ 'success'+ busId);\r\n\r\n        window.alert('Ticket booked successfully!');\r\n          this.router.navigate(['/user']);\r\n      },\r\n      error => {\r\n        // console.log(error);\r\n        window.alert('Error: ' + error.message);\r\n      }\r\n      );\r\n    }\r\n\r\n    // console.log(this.adjSeatStatus);\r\n\r\n    for (const [index, dta] of this.adjSeats.entries()){\r\n\r\n      const male = {\r\n        seatStatus: 'gents',\r\n        seatPrice: dta.seatPrice,\r\n        passengerDetails: {\r\n         passengerName: '',\r\n         passengerAge: '',\r\n         passengerGender: '',\r\n        },\r\n      }\r\n      const female = {\r\n        seatStatus: 'ladies',\r\n        seatPrice: dta.seatPrice,\r\n        passengerDetails: {\r\n         passengerName: '',\r\n         passengerAge: '',\r\n         passengerGender: '',\r\n        },\r\n      }\r\n\r\n      const data = this.adjSeatStatus[index] === 'male' ? male : female;\r\n\r\n      const busId = this.seatService.getBusData();\r\n\r\n      this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/-' + busId +'/seats/' + dta.name +'.json', data)\r\n      .subscribe((res) =>{\r\n        // console.log(dta.seatName + res+ 'success'+ busId) ;\r\n      },\r\n      error => {\r\n        // console.log(error);\r\n        window.alert('Error: ' + error.message);\r\n      }\r\n      );\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}