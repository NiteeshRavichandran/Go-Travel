{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nexport let SeatsComponent = class SeatsComponent {\n  constructor(seatService, bookingService, router, authService, http) {\n    this.seatService = seatService;\n    this.bookingService = bookingService;\n    this.router = router;\n    this.authService = authService;\n    this.http = http;\n    this.lowerSingleSeats = [];\n    this.singleUpperBerthSeats = [];\n    this.doubleLowerBerthSeats = [];\n    this.doubleUpperBerthSeats = [];\n    // const seatData = ti\n    this.selectedSeats = [];\n    this.passengerName = '';\n    this.passengerAge = 0;\n    this.passengerGender = '';\n  }\n  ngOnInit() {\n    const seatData = this.seatService.getSeatData();\n    // console.log(seatData);\n    this.isAdmin = this.authService.isAdmin();\n    console.log(this.isAdmin);\n    for (const seatName in seatData) {\n      if (seatData.hasOwnProperty(seatName)) {\n        const seat = seatData[seatName];\n        if (seatName.startsWith('LS')) {\n          this.lowerSingleSeats.push({\n            name: seatName,\n            ...seat\n          });\n        } else if (seatName.startsWith('SUB')) {\n          this.singleUpperBerthSeats.push({\n            name: seatName,\n            ...seat\n          });\n        } else if (seatName.startsWith('DLB')) {\n          this.doubleLowerBerthSeats.push({\n            name: seatName,\n            ...seat\n          });\n        } else if (seatName.startsWith('DUB')) {\n          this.doubleUpperBerthSeats.push({\n            name: seatName,\n            ...seat\n          });\n        }\n      }\n    }\n    // Sort the arrays by seat name numerically\n    this.lowerSingleSeats.sort((a, b) => {\n      const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n      const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n      return aNumber - bNumber;\n    });\n    this.singleUpperBerthSeats.sort((a, b) => {\n      const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n      const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n      return aNumber - bNumber;\n    });\n    this.doubleLowerBerthSeats.sort((a, b) => {\n      const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n      const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n      return aNumber - bNumber;\n    });\n    this.doubleUpperBerthSeats.sort((a, b) => {\n      const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n      const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n      return aNumber - bNumber;\n    });\n    setTimeout(() => {}, 800);\n    // console.log(this.lowerSingleSeats); \n    // console.log(this.singleUpperBerthSeats); \n    // console.log(this.doubleLowerBerthSeats); \n    // console.log(this.doubleUpperBerthSeats);\n  }\n\n  toggleSeatStatus(seat) {\n    if (seat.seatStatus === 'Available' && this.selectedSeats.length < 5) {\n      seat.seatStatus = 'selected';\n      this.selectedSeats.push(seat);\n    } else if (seat.seatStatus === 'selected') {\n      seat.seatStatus = 'Available';\n      const index = this.selectedSeats.findIndex(s => s.name === seat.name);\n      if (index !== -1) {\n        this.selectedSeats.splice(index, 1);\n      }\n    }\n  }\n  getSeatClass(seat) {\n    return {\n      'booked': seat.seatStatus === 'booked',\n      'available': seat.seatStatus === 'Available',\n      'selected': seat.seatStatus === 'selected',\n      'ladies': seat.seatStatus === 'ladies'\n    };\n  }\n  bookSelectedSeats() {\n    if (this.selectedSeats.length === 0) {\n      return;\n    }\n    this.bookingService.bookSeats(this.selectedSeats);\n    this.router.navigate(['/book']);\n    console.log(this.selectedSeats);\n  }\n  cancelSeat(seatName, seatprice) {\n    const data = {\n      seatStatus: 'Available',\n      seatPrice: seatprice,\n      passengerDetails: {\n        passengerName: '',\n        passengerAge: '',\n        passengerGender: ''\n      }\n    };\n    const busId = this.seatService.getBusData();\n    this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/-' + busId + '/seats/' + seatName + '.json', data).subscribe(res => {\n      // console.log(dta.seatName + res+ 'success'+ busId);\n      window.alert('Ticket canceled successfully!');\n    }, error => {\n      // console.log(error);\n      window.alert('Error: ' + error.message);\n    });\n  }\n};\nSeatsComponent = __decorate([Component({\n  selector: 'app-seats',\n  templateUrl: './seats.component.html',\n  styleUrls: ['./seats.component.css']\n})], SeatsComponent);","map":{"version":3,"names":["Component","SeatsComponent","constructor","seatService","bookingService","router","authService","http","lowerSingleSeats","singleUpperBerthSeats","doubleLowerBerthSeats","doubleUpperBerthSeats","selectedSeats","passengerName","passengerAge","passengerGender","ngOnInit","seatData","getSeatData","isAdmin","console","log","seatName","hasOwnProperty","seat","startsWith","push","name","sort","a","b","aNumber","parseInt","match","bNumber","setTimeout","toggleSeatStatus","seatStatus","length","index","findIndex","s","splice","getSeatClass","bookSelectedSeats","bookSeats","navigate","cancelSeat","seatprice","data","seatPrice","passengerDetails","busId","getBusData","put","subscribe","res","window","alert","error","message","__decorate","selector","templateUrl","styleUrls"],"sources":["E:\\Web\\academy-project\\src\\app\\seats\\seats.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { SeatService } from '../seat.service';\r\nimport { BookingService } from '../booking.service';\r\nimport { Router } from '@angular/router';\r\nimport { AuthService } from '../auth.service';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClient } from '@angular/common/http'; \r\n\r\nexport interface Seat {\r\n  name: string;\r\n  seatStatus: 'Available' | 'selected' | 'booked' | 'ladies';\r\n  passengerName?: string;\r\n  passengerAge?: number;\r\n  passengerGender?: string;\r\n  seatPrice?: number;\r\n}\r\n\r\n\r\n@Component({\r\n  selector: 'app-seats',\r\n  templateUrl: './seats.component.html',\r\n  styleUrls: ['./seats.component.css']\r\n})\r\n\r\n\r\n  \r\nexport class SeatsComponent {\r\n\r\n  constructor(private seatService: SeatService, private bookingService: BookingService, private router: Router, private authService: AuthService, private http: HttpClient) {} \r\n\r\n  lowerSingleSeats: any[] = []; \r\n  singleUpperBerthSeats: any[] = []; \r\n  doubleLowerBerthSeats: any[] = []; \r\n  doubleUpperBerthSeats: any[] = []; \r\n\r\n  \r\n  isAdmin:boolean;\r\n\r\n  ngOnInit(): void {\r\n    const seatData = this.seatService.getSeatData(); \r\n    // console.log(seatData);\r\n    this.isAdmin = this.authService.isAdmin();\r\n    console.log(this.isAdmin);\r\n\r\n    for (const seatName in seatData) {\r\n      if (seatData.hasOwnProperty(seatName)) {\r\n        const seat = seatData[seatName];\r\n  \r\n        if (seatName.startsWith('LS')) {\r\n          this.lowerSingleSeats.push({ name: seatName, ...seat });\r\n        } else if (seatName.startsWith('SUB')) {\r\n          this.singleUpperBerthSeats.push({ name: seatName, ...seat });\r\n        } else if (seatName.startsWith('DLB')) {\r\n          this.doubleLowerBerthSeats.push({ name: seatName, ...seat });\r\n        } else if (seatName.startsWith('DUB')) {\r\n          this.doubleUpperBerthSeats.push({ name: seatName, ...seat });\r\n        }\r\n      }\r\n    }\r\n\r\n    // Sort the arrays by seat name numerically\r\nthis.lowerSingleSeats.sort((a, b) => {\r\n  const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\r\n  const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\r\n  return aNumber - bNumber;\r\n});\r\n\r\nthis.singleUpperBerthSeats.sort((a, b) => {\r\n  const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\r\n  const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\r\n  return aNumber - bNumber;\r\n});\r\n\r\nthis.doubleLowerBerthSeats.sort((a, b) => {\r\n  const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\r\n  const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\r\n  return aNumber - bNumber;\r\n});\r\n\r\nthis.doubleUpperBerthSeats.sort((a, b) => {\r\n  const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\r\n  const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\r\n  return aNumber - bNumber;\r\n});\r\n\r\n    setTimeout(() => {\r\n\r\n    }, 800);  \r\n\r\n    // console.log(this.lowerSingleSeats); \r\n    // console.log(this.singleUpperBerthSeats); \r\n    // console.log(this.doubleLowerBerthSeats); \r\n    // console.log(this.doubleUpperBerthSeats);\r\n\r\n  }\r\n    // const seatData = ti\r\n    selectedSeats: Seat[] = [];\r\n    passengerName: string = '';\r\n    passengerAge: number = 0;\r\n    passengerGender: string = '';\r\n  \r\n    \r\n    toggleSeatStatus(seat: any) {\r\n      if (seat.seatStatus === 'Available' && this.selectedSeats.length < 5) {\r\n        seat.seatStatus = 'selected';\r\n        this.selectedSeats.push(seat);\r\n      } else if (seat.seatStatus === 'selected') {\r\n        seat.seatStatus = 'Available';\r\n        const index = this.selectedSeats.findIndex((s) => s.name === seat.name);\r\n        if (index !== -1) {\r\n          this.selectedSeats.splice(index, 1);\r\n        }\r\n      } \r\n    }\r\n\r\n    \r\n    getSeatClass(seat: Seat) {\r\n      return {\r\n        'booked': seat.seatStatus === 'booked',\r\n        'available': seat.seatStatus === 'Available',\r\n        'selected': seat.seatStatus === 'selected',\r\n        'ladies': seat.seatStatus === 'ladies',\r\n      };\r\n    }\r\n\r\n    bookSelectedSeats() {\r\n      if (this.selectedSeats.length === 0) {\r\n        return;\r\n      }\r\n      this.bookingService.bookSeats(this.selectedSeats);\r\n      this.router.navigate(['/book']);\r\n      console.log(this.selectedSeats);\r\n    }\r\n\r\n    cancelSeat(seatName:string, seatprice: number){\r\n\r\n      const data = {\r\n        seatStatus: 'Available',\r\n        seatPrice: seatprice,\r\n        passengerDetails: {\r\n         passengerName: '',\r\n         passengerAge: '',\r\n         passengerGender: '',\r\n        },\r\n      }\r\n\r\n      const busId = this.seatService.getBusData();\r\n\r\n      this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/-' + busId +'/seats/' + seatName +'.json', data)\r\n      .subscribe((res) =>{\r\n        // console.log(dta.seatName + res+ 'success'+ busId);\r\n\r\n        window.alert('Ticket canceled successfully!');\r\n      },\r\n      error => {\r\n        // console.log(error);\r\n        window.alert('Error: ' + error.message);\r\n      }\r\n      );\r\n    }\r\n    \r\n  }"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}