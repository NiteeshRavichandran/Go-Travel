{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/seat.service\";\nimport * as i2 from \"src/app/services/booking.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/auth/auth.service\";\nimport * as i5 from \"@angular/common\";\nfunction SeatsComponent_label_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"label\", 17);\n    i0.ɵɵlistener(\"click\", function SeatsComponent_label_4_Template_label_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const seat_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.toggleSeatStatus(seat_r5));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const seat_r5 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", ctx_r0.getSeatClass(seat_r5.seatStatus));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", seat_r5.name, \" \");\n  }\n}\nfunction SeatsComponent_label_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"label\", 18);\n    i0.ɵɵlistener(\"click\", function SeatsComponent_label_6_Template_label_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const seat_r8 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.toggleSeatStatus(seat_r8));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const seat_r8 = ctx.$implicit;\n    const i_r9 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"margin-left\", i_r9 < 6);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.getSeatClass(seat_r8.seatStatus));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", seat_r8.name, \" \");\n  }\n}\nfunction SeatsComponent_label_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"label\", 18);\n    i0.ɵɵlistener(\"click\", function SeatsComponent_label_9_Template_label_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const seat_r12 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.toggleSeatStatus(seat_r12));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const seat_r12 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", ctx_r2.getSeatClass(seat_r12.seatStatus));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", seat_r12.name, \" \");\n  }\n}\nfunction SeatsComponent_label_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"label\", 18);\n    i0.ɵɵlistener(\"click\", function SeatsComponent_label_11_Template_label_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const seat_r15 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.toggleSeatStatus(seat_r15));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const seat_r15 = ctx.$implicit;\n    const i_r16 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"margin-left\", i_r16 < 6);\n    i0.ɵɵproperty(\"ngClass\", ctx_r3.getSeatClass(seat_r15.seatStatus));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", seat_r15.name, \" \");\n  }\n}\nfunction SeatsComponent_div_57_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const seat_r20 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(seat_r20.name);\n  }\n}\nfunction SeatsComponent_div_57_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"h4\");\n    i0.ɵɵtext(2, \"Selected Seats\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\");\n    i0.ɵɵtemplate(4, SeatsComponent_div_57_li_4_Template, 2, 1, \"li\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function SeatsComponent_div_57_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.bookSelectedSeats());\n    });\n    i0.ɵɵtext(6, \" Book Seats \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.selectedSeats);\n  }\n}\nexport let SeatsComponent = /*#__PURE__*/(() => {\n  var _class;\n  class SeatsComponent {\n    constructor(seatService, bookingService, router, authService) {\n      this.seatService = seatService;\n      this.bookingService = bookingService;\n      this.router = router;\n      this.authService = authService;\n      this.lowerSingleSeats = [];\n      this.singleUpperBerthSeats = [];\n      this.doubleLowerBerthSeats = [];\n      this.doubleUpperBerthSeats = [];\n      this.allSeats = [];\n      this.allSeats2 = [];\n      // const seatData = ti\n      this.selectedSeats = [];\n      this.adjSeats = [];\n      this.passengerName = '';\n      this.passengerAge = 0;\n      this.passengerGender = '';\n      setTimeout(() => {\n        this.allSeats = this.allSeats.concat(this.singleUpperBerthSeats, this.doubleLowerBerthSeats, this.doubleUpperBerthSeats, this.lowerSingleSeats);\n        this.allSeats2 = this.allSeats2.concat(this.doubleLowerBerthSeats, this.doubleUpperBerthSeats);\n      }, 500);\n    }\n    ngOnInit() {\n      const seatData = this.seatService.getSeatData();\n      // console.log(seatData);\n      for (const seatName in seatData) {\n        if (seatData.hasOwnProperty(seatName)) {\n          const seat = seatData[seatName];\n          if (seatName.startsWith('LS')) {\n            this.lowerSingleSeats.push({\n              name: seatName,\n              ...seat\n            });\n          } else if (seatName.startsWith('SUB')) {\n            this.singleUpperBerthSeats.push({\n              name: seatName,\n              ...seat\n            });\n          } else if (seatName.startsWith('DLB')) {\n            this.doubleLowerBerthSeats.push({\n              name: seatName,\n              ...seat\n            });\n          } else if (seatName.startsWith('DUB')) {\n            this.doubleUpperBerthSeats.push({\n              name: seatName,\n              ...seat\n            });\n          }\n        }\n      }\n      // Sort the arrays by seat name numerically\n      this.lowerSingleSeats.sort((a, b) => {\n        const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n        const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n        return aNumber - bNumber;\n      });\n      this.singleUpperBerthSeats.sort((a, b) => {\n        const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n        const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n        return aNumber - bNumber;\n      });\n      this.doubleLowerBerthSeats.sort((a, b) => {\n        const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n        const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n        return aNumber - bNumber;\n      });\n      this.doubleUpperBerthSeats.sort((a, b) => {\n        const aNumber = parseInt(a.name.match(/\\d+/)[0], 10);\n        const bNumber = parseInt(b.name.match(/\\d+/)[0], 10);\n        return aNumber - bNumber;\n      });\n      setTimeout(() => {}, 300);\n      // console.log(this.lowerSingleSeats);\n      // console.log(this.singleUpperBerthSeats);\n      // console.log(this.doubleLowerBerthSeats);\n      // console.log(this.doubleUpperBerthSeats);\n    }\n\n    logout() {\n      this.authService.logout();\n    }\n    toggleSeatStatus(seat) {\n      if (seat.seatStatus === 'Available' && this.selectedSeats.length < 5) {\n        seat.seatStatus = 'selected';\n        this.selectedSeats.push(seat);\n      } else if (seat.seatStatus === 'ladies' && this.selectedSeats.length < 5) {\n        seat.seatStatus = 'ladiesSelected';\n        this.selectedSeats.push(seat);\n      } else if (seat.seatStatus === 'ladiesSelected' && this.selectedSeats.length < 5) {\n        seat.seatStatus = 'ladies';\n        const index = this.selectedSeats.findIndex(s => s.name === seat.name);\n        if (index !== -1) {\n          this.selectedSeats.splice(index, 1);\n        }\n      } else if (seat.seatStatus === 'gents' && this.selectedSeats.length < 5) {\n        seat.seatStatus = 'gentsSelected';\n        this.selectedSeats.push(seat);\n      } else if (seat.seatStatus === 'gentsSelected' && this.selectedSeats.length < 5) {\n        seat.seatStatus = 'gents';\n        const index = this.selectedSeats.findIndex(s => s.name === seat.name);\n        if (index !== -1) {\n          this.selectedSeats.splice(index, 1);\n        }\n      } else if (seat.seatStatus === 'selected') {\n        seat.seatStatus = 'Available';\n        const index = this.selectedSeats.findIndex(s => s.name === seat.name);\n        if (index !== -1) {\n          this.selectedSeats.splice(index, 1);\n        }\n      }\n    }\n    processSeats(seatsArray) {\n      seatsArray.forEach((seat, index, array) => {\n        if (seat.seatStatus === 'selected') {\n          const adjacentSeatIndex = index + 1 <= 6 ? index + 6 : index - 6;\n          if (array[adjacentSeatIndex].seatStatus !== 'booked' && array[adjacentSeatIndex].seatStatus !== 'selected') {\n            this.adjSeats.push(array[adjacentSeatIndex]);\n          }\n        }\n      });\n    }\n    getSeatClass(seatStatus) {\n      return {\n        booked: seatStatus === 'booked',\n        Available: seatStatus === 'Available',\n        selected: seatStatus === 'selected',\n        ladies: seatStatus === 'ladies',\n        ladiesSelected: seatStatus === 'ladiesSelected',\n        gents: seatStatus === 'gents',\n        gentsSelected: seatStatus === 'gentsSelected'\n      };\n    }\n    bookSelectedSeats() {\n      if (this.selectedSeats.length === 0) {\n        return;\n      }\n      this.processSeats(this.doubleLowerBerthSeats);\n      this.processSeats(this.doubleUpperBerthSeats);\n      this.bookingService.bookSeats(this.selectedSeats, this.adjSeats);\n      this.router.navigate(['/user/book']);\n      // console.log(this.selectedSeats);\n    }\n  }\n  _class = SeatsComponent;\n  _class.ɵfac = function SeatsComponent_Factory(t) {\n    return new (t || _class)(i0.ɵɵdirectiveInject(i1.SeatService), i0.ɵɵdirectiveInject(i2.BookingService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.AuthService));\n  };\n  _class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _class,\n    selectors: [[\"app-seats\"]],\n    decls: 58,\n    vars: 5,\n    consts: [[1, \"container\"], [1, \"ctnr\"], [1, \"seats\"], [1, \"seat-container\"], [\"class\", \"seat\", 3, \"ngClass\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"berth\", 3, \"ngClass\", \"margin-left\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"berth\", 3, \"ngClass\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"legend\"], [1, \"legend-item\"], [1, \"legend-color\", \"booked\"], [1, \"legend-color\", \"available\"], [1, \"legend-color\", \"ladies\"], [1, \"legend-color\", \"ladiesSelected\"], [1, \"legend-color\", \"gents\"], [1, \"legend-color\", \"gentsSelected\"], [1, \"legend-color\", \"selected\"], [4, \"ngIf\"], [1, \"seat\", 3, \"ngClass\", \"click\"], [1, \"berth\", 3, \"ngClass\", \"click\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-primary\", 3, \"click\"]],\n    template: function SeatsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3);\n        i0.ɵɵtemplate(4, SeatsComponent_label_4_Template, 2, 2, \"label\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 3);\n        i0.ɵɵtemplate(6, SeatsComponent_label_6_Template, 2, 4, \"label\", 5);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"div\", 2)(8, \"div\", 3);\n        i0.ɵɵtemplate(9, SeatsComponent_label_9_Template, 2, 2, \"label\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 3);\n        i0.ɵɵtemplate(11, SeatsComponent_label_11_Template, 2, 4, \"label\", 5);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 7)(13, \"h3\");\n        i0.ɵɵtext(14, \"LEGEND\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"ul\")(16, \"li\", 8);\n        i0.ɵɵelement(17, \"div\", 9);\n        i0.ɵɵelementStart(18, \"span\");\n        i0.ɵɵtext(19, \"Booked\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"li\", 8);\n        i0.ɵɵelement(21, \"div\", 10);\n        i0.ɵɵelementStart(22, \"span\");\n        i0.ɵɵtext(23, \"Available\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"li\", 8);\n        i0.ɵɵelement(25, \"div\", 11);\n        i0.ɵɵelementStart(26, \"span\");\n        i0.ɵɵtext(27, \"Ladies\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(28, \"li\", 8);\n        i0.ɵɵelement(29, \"div\", 12);\n        i0.ɵɵelementStart(30, \"span\");\n        i0.ɵɵtext(31, \"Ladies Selected\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(32, \"li\", 8);\n        i0.ɵɵelement(33, \"div\", 13);\n        i0.ɵɵelementStart(34, \"span\");\n        i0.ɵɵtext(35, \"Gents\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(36, \"li\", 8);\n        i0.ɵɵelement(37, \"div\", 14);\n        i0.ɵɵelementStart(38, \"span\");\n        i0.ɵɵtext(39, \"Gents Selected\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(40, \"li\", 8);\n        i0.ɵɵelement(41, \"div\", 15);\n        i0.ɵɵelementStart(42, \"span\");\n        i0.ɵɵtext(43, \"Selected\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(44, \"p\");\n        i0.ɵɵtext(45, \"Abbreviations:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"ul\")(47, \"li\");\n        i0.ɵɵtext(48, \"LS - Lower Seat\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(49, \"li\");\n        i0.ɵɵtext(50, \"DLB - Double Lower Berth\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(51, \"li\");\n        i0.ɵɵtext(52, \"DUB - Double Upper Berth\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(53, \"li\");\n        i0.ɵɵtext(54, \"SLB - Single Upper Berth\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelement(55, \"br\")(56, \"br\");\n        i0.ɵɵtemplate(57, SeatsComponent_div_57_Template, 7, 1, \"div\", 16);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.lowerSingleSeats);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.doubleLowerBerthSeats);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.singleUpperBerthSeats);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.doubleUpperBerthSeats);\n        i0.ɵɵadvance(46);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedSeats.length > 0);\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf],\n    styles: [\".seats[_ngcontent-%COMP%]{width:275px;height:650px;display:flex;justify-content:center;column-gap:35px;background-color:#dacdcd;margin-right:20px}.ctnr[_ngcontent-%COMP%]{display:flex;margin-top:30px}.seat-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:column;justify-content:center;align-items:center}.seat[_ngcontent-%COMP%]{width:45px;height:40px;margin:5px;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:10px;cursor:pointer}.berth[_ngcontent-%COMP%]{width:50px;height:90px;margin:5px;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:10px;cursor:pointer}.booked[_ngcontent-%COMP%]{background-color:#e97f68;cursor:not-allowed}.Available[_ngcontent-%COMP%]{background-color:#fff}.ladies[_ngcontent-%COMP%]{background-color:#facfd5}.ladiesSelected[_ngcontent-%COMP%]{background-color:#db7888}.gents[_ngcontent-%COMP%]{background-color:#bba9a9}.gentsSelected[_ngcontent-%COMP%]{background-color:#726969}.selected[_ngcontent-%COMP%]{background-color:#66cdaa}.legend[_ngcontent-%COMP%]{border:1px solid #ccc;padding:10px;margin:20px;max-width:300px;height:auto}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:5px}.legend-color[_ngcontent-%COMP%]{border:1px solid black;width:20px;height:20px;margin-right:10px}.seat-item[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}label[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}\"]\n  });\n  return SeatsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}