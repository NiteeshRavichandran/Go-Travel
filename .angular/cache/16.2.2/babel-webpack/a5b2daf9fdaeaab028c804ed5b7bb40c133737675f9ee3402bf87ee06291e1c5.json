{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nexport let BookTicketsComponent = class BookTicketsComponent {\n  constructor(bookingService, fb, http, seatService) {\n    this.bookingService = bookingService;\n    this.fb = fb;\n    this.http = http;\n    this.seatService = seatService;\n    this.selectedSeats = [];\n    this.bookingForms = [];\n  }\n  ngOnInit() {\n    // Get the selected seats data directly from the service\n    this.selectedSeats = this.bookingService.getSelectedSeatsData();\n    this.initializeForms();\n  }\n  initializeForms() {\n    // Clear existing forms\n    this.bookingForms = [];\n    // Create a form for each selected seat\n    this.selectedSeats.forEach(seat => {\n      const form = this.fb.group({\n        passengerName: [seat.passengerName || '', Validators.required],\n        passengerAge: [seat.passengerAge || 0, [Validators.required, Validators.min(1)]],\n        passengerGender: [seat.passengerGender || '', Validators.required]\n      });\n      this.bookingForms.push(form);\n    });\n  }\n  onSubmit() {\n    // Handle form submission here, e.g., send passenger data to the server\n    if (this.bookingForms.every(form => form.valid)) {\n      const passengerDataArray = this.bookingForms.map((form, index) => ({\n        seatName: this.selectedSeats[index].name,\n        passengerData: form.value\n      }));\n      // Send passengerDataArray to the server or perform any other required actions\n      // console.log(this.bookingForms);  \n      console.log(passengerDataArray);\n      for (const dta of passengerDataArray) {\n        const data = {\n          seatStatus: 'booked',\n          passengerDetails: {\n            passengerName: dta.passengerData.passengerName,\n            passengerAge: dta.passengerData.passengerAge,\n            passengerGender: dta.passengerData.passengerGender\n          }\n        };\n        const busId = this.s;\n        this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/');\n      }\n    }\n  }\n};\nBookTicketsComponent = __decorate([Component({\n  selector: 'app-book-tickets',\n  templateUrl: './book-tickets.component.html',\n  styleUrls: ['./book-tickets.component.scss']\n})], BookTicketsComponent);","map":{"version":3,"names":["Component","Validators","BookTicketsComponent","constructor","bookingService","fb","http","seatService","selectedSeats","bookingForms","ngOnInit","getSelectedSeatsData","initializeForms","forEach","seat","form","group","passengerName","required","passengerAge","min","passengerGender","push","onSubmit","every","valid","passengerDataArray","map","index","seatName","name","passengerData","value","console","log","dta","data","seatStatus","passengerDetails","busId","s","put","__decorate","selector","templateUrl","styleUrls"],"sources":["E:\\Web\\academy-project\\src\\app\\book-tickets\\book-tickets.component.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { BookingService } from '../booking.service';\r\nimport { Seat } from '../seats/seats.component';\r\n\r\n@Component({\r\n  selector: 'app-book-tickets',\r\n  templateUrl: './book-tickets.component.html',\r\n  styleUrls: ['./book-tickets.component.scss'],\r\n})\r\nexport class BookTicketsComponent implements OnInit {\r\n  selectedSeats: Seat[] = [];\r\n  bookingForms: FormGroup[] = [];\r\n\r\n  constructor(private bookingService: BookingService, private fb: FormBuilder, private http: HttpClient, private seatService: Seat) {}\r\n\r\n  ngOnInit(): void {\r\n    // Get the selected seats data directly from the service\r\n    this.selectedSeats = this.bookingService.getSelectedSeatsData();\r\n    this.initializeForms();\r\n  }\r\n\r\n  initializeForms() {\r\n    // Clear existing forms\r\n    this.bookingForms = [];\r\n\r\n    // Create a form for each selected seat\r\n    this.selectedSeats.forEach((seat) => {\r\n      const form = this.fb.group({\r\n        passengerName: [seat.passengerName || '', Validators.required],\r\n        passengerAge: [seat.passengerAge || 0, [Validators.required, Validators.min(1)]],\r\n        passengerGender: [seat.passengerGender || '', Validators.required],\r\n      });\r\n      this.bookingForms.push(form);\r\n    });\r\n  }\r\n\r\n  onSubmit() {\r\n    // Handle form submission here, e.g., send passenger data to the server\r\n    if (this.bookingForms.every((form) => form.valid)) {\r\n      const passengerDataArray = this.bookingForms.map((form, index) => ({\r\n        seatName: this.selectedSeats[index].name,\r\n        passengerData: form.value,\r\n      }));\r\n\r\n      // Send passengerDataArray to the server or perform any other required actions\r\n      // console.log(this.bookingForms);  \r\n      console.log(passengerDataArray);\r\n      \r\n      for(const dta of passengerDataArray){\r\n\r\n        const data = {\r\n          seatStatus: 'booked',\r\n          passengerDetails: {\r\n           passengerName: dta.passengerData.passengerName,\r\n           passengerAge: dta.passengerData.passengerAge,\r\n           passengerGender: dta.passengerData.passengerGender,\r\n          },\r\n        }\r\n\r\n        const busId = this.s\r\n        this.http.put('https://go-travel-42246-default-rtdb.firebaseio.com/busses/')\r\n      }\r\n\r\n\r\n\r\n\r\n    }\r\n  }\r\n}\r\n"],"mappings":";AACA,SAASA,SAAS,QAAgB,eAAe;AACjD,SAAiCC,UAAU,QAAQ,gBAAgB;AAS5D,WAAMC,oBAAoB,GAA1B,MAAMA,oBAAoB;EAI/BC,YAAoBC,cAA8B,EAAUC,EAAe,EAAUC,IAAgB,EAAUC,WAAiB;IAA5G,KAAAH,cAAc,GAAdA,cAAc;IAA0B,KAAAC,EAAE,GAAFA,EAAE;IAAuB,KAAAC,IAAI,GAAJA,IAAI;IAAsB,KAAAC,WAAW,GAAXA,WAAW;IAH1H,KAAAC,aAAa,GAAW,EAAE;IAC1B,KAAAC,YAAY,GAAgB,EAAE;EAEqG;EAEnIC,QAAQA,CAAA;IACN;IACA,IAAI,CAACF,aAAa,GAAG,IAAI,CAACJ,cAAc,CAACO,oBAAoB,EAAE;IAC/D,IAAI,CAACC,eAAe,EAAE;EACxB;EAEAA,eAAeA,CAAA;IACb;IACA,IAAI,CAACH,YAAY,GAAG,EAAE;IAEtB;IACA,IAAI,CAACD,aAAa,CAACK,OAAO,CAAEC,IAAI,IAAI;MAClC,MAAMC,IAAI,GAAG,IAAI,CAACV,EAAE,CAACW,KAAK,CAAC;QACzBC,aAAa,EAAE,CAACH,IAAI,CAACG,aAAa,IAAI,EAAE,EAAEhB,UAAU,CAACiB,QAAQ,CAAC;QAC9DC,YAAY,EAAE,CAACL,IAAI,CAACK,YAAY,IAAI,CAAC,EAAE,CAAClB,UAAU,CAACiB,QAAQ,EAAEjB,UAAU,CAACmB,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAChFC,eAAe,EAAE,CAACP,IAAI,CAACO,eAAe,IAAI,EAAE,EAAEpB,UAAU,CAACiB,QAAQ;OAClE,CAAC;MACF,IAAI,CAACT,YAAY,CAACa,IAAI,CAACP,IAAI,CAAC;IAC9B,CAAC,CAAC;EACJ;EAEAQ,QAAQA,CAAA;IACN;IACA,IAAI,IAAI,CAACd,YAAY,CAACe,KAAK,CAAET,IAAI,IAAKA,IAAI,CAACU,KAAK,CAAC,EAAE;MACjD,MAAMC,kBAAkB,GAAG,IAAI,CAACjB,YAAY,CAACkB,GAAG,CAAC,CAACZ,IAAI,EAAEa,KAAK,MAAM;QACjEC,QAAQ,EAAE,IAAI,CAACrB,aAAa,CAACoB,KAAK,CAAC,CAACE,IAAI;QACxCC,aAAa,EAAEhB,IAAI,CAACiB;OACrB,CAAC,CAAC;MAEH;MACA;MACAC,OAAO,CAACC,GAAG,CAACR,kBAAkB,CAAC;MAE/B,KAAI,MAAMS,GAAG,IAAIT,kBAAkB,EAAC;QAElC,MAAMU,IAAI,GAAG;UACXC,UAAU,EAAE,QAAQ;UACpBC,gBAAgB,EAAE;YACjBrB,aAAa,EAAEkB,GAAG,CAACJ,aAAa,CAACd,aAAa;YAC9CE,YAAY,EAAEgB,GAAG,CAACJ,aAAa,CAACZ,YAAY;YAC5CE,eAAe,EAAEc,GAAG,CAACJ,aAAa,CAACV;;SAErC;QAED,MAAMkB,KAAK,GAAG,IAAI,CAACC,CAAC;QACpB,IAAI,CAAClC,IAAI,CAACmC,GAAG,CAAC,6DAA6D,CAAC;;;EAOlF;CACD;AA3DYvC,oBAAoB,GAAAwC,UAAA,EALhC1C,SAAS,CAAC;EACT2C,QAAQ,EAAE,kBAAkB;EAC5BC,WAAW,EAAE,+BAA+B;EAC5CC,SAAS,EAAE,CAAC,+BAA+B;CAC5C,CAAC,C,EACW3C,oBAAoB,CA2DhC"},"metadata":{},"sourceType":"module","externalDependencies":[]}